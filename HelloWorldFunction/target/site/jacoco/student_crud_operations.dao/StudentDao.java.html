<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StudentDao.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">A sample Hello World created for SAM CLI.</a> &gt; <a href="index.source.html" class="el_package">student_crud_operations.dao</a> &gt; <span class="el_source">StudentDao.java</span></div><h1>StudentDao.java</h1><pre class="source lang-java linenums">package student_crud_operations.dao;

import software.amazon.awssdk.services.dynamodb.DynamoDbClient;
import software.amazon.awssdk.services.dynamodb.model.*;
import software.amazon.awssdk.services.dynamodb.model.GetItemRequest;
import software.amazon.awssdk.services.dynamodb.model.GetItemResponse;
import software.amazon.awssdk.services.dynamodb.model.PutItemRequest;

import java.util.HashMap;
import java.util.Map;

import student_crud_operations.pojo.Student;

public class StudentDao {
    private final DynamoDbClient dynamoDbClient;
<span class="fc" id="L16">    private final String tableName = &quot;Student&quot;;</span>

<span class="fc" id="L18">    public StudentDao(DynamoDbClient dynamoDbClient) {</span>
<span class="fc" id="L19">        this.dynamoDbClient = dynamoDbClient;</span>
<span class="fc" id="L20">    }</span>

    // Create student
    public PutItemResponse saveStudent(Student student) {
<span class="fc" id="L24">        Map&lt;String, AttributeValue&gt; item = new HashMap&lt;&gt;();</span>
<span class="fc" id="L25">        item.put(&quot;S_NO&quot;, AttributeValue.builder().s(student.getS_NO()).build());</span>
<span class="fc" id="L26">        item.put(&quot;CollegeID&quot;, AttributeValue.builder().s(student.getCollegeID()).build());</span>
<span class="fc" id="L27">        item.put(&quot;AdmissionID&quot;, AttributeValue.builder().s(student.getAdmissionID()).build());</span>
<span class="fc" id="L28">        item.put(&quot;CAMPUS&quot;, AttributeValue.builder().s(student.getCAMPUS()).build());</span>
<span class="fc" id="L29">        item.put(&quot;Pursuing_branch&quot;, AttributeValue.builder().s(student.getPursuing_branch()).build());</span>
<span class="fc" id="L30">        item.put(&quot;Pursuing_campus&quot;, AttributeValue.builder().s(student.getPursuing_campus()).build());</span>
<span class="fc" id="L31">        item.put(&quot;AADHAR_NO&quot;, AttributeValue.builder().s(student.getAADHAR_NO()).build());</span>
<span class="fc" id="L32">        item.put(&quot;DOB&quot;, AttributeValue.builder().s(student.getDOB()).build());</span>
<span class="fc" id="L33">        item.put(&quot;STUDENT_NAME_AS_PER_SSC&quot;, AttributeValue.builder().s(student.getSTUDENT_NAME_AS_PER_SSC()).build());</span>
<span class="fc" id="L34">        item.put(&quot;FATHER_NAME_AS_PER_SSC&quot;, AttributeValue.builder().s(student.getFATHER_NAME_AS_PER_SSC()).build());</span>
<span class="fc" id="L35">        item.put(&quot;MOTHER_NAME_AS_PER_SSC&quot;, AttributeValue.builder().s(student.getMOTHER_NAME_AS_PER_SSC()).build());</span>
<span class="fc" id="L36">        item.put(&quot;OCCUPATION&quot;, AttributeValue.builder().s(student.getOCCUPATION()).build());</span>
<span class="fc" id="L37">        item.put(&quot;F_OR_M&quot;, AttributeValue.builder().s(student.getF_OR_M()).build());</span>
<span class="fc" id="L38">        item.put(&quot;Roll_Number&quot;, AttributeValue.builder().s(student.getRoll_Number()).build());</span>
<span class="fc" id="L39">        item.put(&quot;Section&quot;, AttributeValue.builder().s(student.getSection()).build());</span>
<span class="fc" id="L40">        item.put(&quot;profile_picture&quot;, AttributeValue.builder().s(student.getProfile_picture()).build());</span>
<span class="fc" id="L41">        item.put(&quot;Student_Class&quot;, AttributeValue.builder().s(student.getStudent_Class()).build());</span>
<span class="fc" id="L42">        item.put(&quot;CAST&quot;, AttributeValue.builder().s(student.getCAST()).build());</span>
<span class="fc" id="L43">        item.put(&quot;SUB_CAST&quot;, AttributeValue.builder().s(student.getSUB_CAST()).build());</span>
<span class="fc" id="L44">        item.put(&quot;MOBILE_NO_1&quot;, AttributeValue.builder().s(student.getMOBILE_NO_1()).build());</span>
<span class="fc" id="L45">        item.put(&quot;MOBILE_NO_2&quot;, AttributeValue.builder().s(student.getMOBILE_NO_2()).build());</span>
<span class="fc" id="L46">        item.put(&quot;DIST_NAME&quot;, AttributeValue.builder().s(student.getDIST_NAME()).build());</span>
<span class="fc" id="L47">        item.put(&quot;PIN_CODE&quot;, AttributeValue.builder().s(student.getPIN_CODE()).build());</span>

<span class="fc" id="L49">        PutItemRequest putItemRequest = PutItemRequest.builder()</span>
<span class="fc" id="L50">                .tableName(tableName)</span>
<span class="fc" id="L51">                .item(item)</span>
<span class="fc" id="L52">                .build();</span>
        try {
<span class="fc" id="L54">            PutItemResponse response = dynamoDbClient.putItem(putItemRequest);</span>
            // Checking the response
<span class="fc" id="L56">            System.out.println(&quot;HTTP Status Code: &quot; + response.sdkHttpResponse().statusCode());</span>

<span class="fc" id="L58">            return response;</span>
<span class="nc" id="L59">        } catch (DynamoDbException e) {</span>
<span class="nc" id="L60">            System.err.println(</span>
<span class="nc" id="L61">                    &quot;Error saving student to DynamoDB: &quot; + e.getMessage());</span>
<span class="nc" id="L62">            e.printStackTrace();</span>
<span class="nc" id="L63">            throw new RuntimeException(&quot;Failed to save student&quot;, e);</span>
        }
    }

    // Read student by ID
    public Student getStudentByAdmissionID(String id) {
<span class="fc" id="L69">        Map&lt;String, AttributeValue&gt; key = new HashMap&lt;&gt;();</span>
<span class="fc" id="L70">        key.put(&quot;AdmissionID&quot;, AttributeValue.builder().s(id).build());</span>
<span class="fc" id="L71">        GetItemRequest getItemRequest = GetItemRequest.builder()</span>
<span class="fc" id="L72">                .tableName(tableName)</span>
<span class="fc" id="L73">                .key(key)</span>
<span class="fc" id="L74">                .build();</span>
<span class="fc" id="L75">        GetItemResponse response = dynamoDbClient.getItem(getItemRequest);</span>
<span class="fc bfc" id="L76" title="All 2 branches covered.">        if (!response.hasItem()) {</span>
<span class="fc" id="L77">            return null; // No student found</span>
        }
<span class="fc" id="L79">        Map&lt;String, AttributeValue&gt; item = response.item();</span>
<span class="fc" id="L80">        Student student = new Student();</span>
<span class="fc" id="L81">        student.setS_NO(item.get(&quot;S_NO&quot;).s());</span>
<span class="fc" id="L82">        student.setCollegeID(item.get(&quot;CollegeID&quot;).s());</span>
<span class="fc" id="L83">        student.setAdmissionID(item.get(&quot;AdmissionID&quot;).s());</span>
<span class="fc" id="L84">        student.setCAMPUS(item.get(&quot;CAMPUS&quot;).s());</span>
<span class="fc" id="L85">        student.setPursuing_branch(item.get(&quot;Pursuing_branch&quot;).s());</span>
<span class="fc" id="L86">        student.setPursuing_campus(item.get(&quot;Pursuing_campus&quot;).s());</span>
<span class="fc" id="L87">        student.setAADHAR_NO(item.get(&quot;AADHAR_NO&quot;).s());</span>
<span class="fc" id="L88">        student.setDOB(item.get(&quot;DOB&quot;).s());</span>
<span class="fc" id="L89">        student.setSTUDENT_NAME_AS_PER_SSC(item.get(&quot;STUDENT_NAME_AS_PER_SSC&quot;).s());</span>
<span class="fc" id="L90">        student.setFATHER_NAME_AS_PER_SSC(item.get(&quot;FATHER_NAME_AS_PER_SSC&quot;).s());</span>
<span class="fc" id="L91">        student.setMOTHER_NAME_AS_PER_SSC(item.get(&quot;MOTHER_NAME_AS_PER_SSC&quot;).s());</span>
<span class="fc" id="L92">        student.setOCCUPATION(item.get(&quot;OCCUPATION&quot;).s());</span>
<span class="fc" id="L93">        student.setF_OR_M(item.get(&quot;F_OR_M&quot;).s());</span>
<span class="fc" id="L94">        student.setRoll_Number(item.get(&quot;Roll_Number&quot;).s());</span>
<span class="fc" id="L95">        student.setSection(item.get(&quot;Section&quot;).s());</span>
<span class="fc" id="L96">        student.setProfile_picture(item.get(&quot;profile_picture&quot;).s());</span>
<span class="fc" id="L97">        student.setStudent_Class(item.get(&quot;Student_Class&quot;).s());</span>
<span class="fc" id="L98">        student.setCAST(item.get(&quot;CAST&quot;).s());</span>
<span class="fc" id="L99">        student.setSUB_CAST(item.get(&quot;SUB_CAST&quot;).s());</span>
<span class="fc" id="L100">        student.setMOBILE_NO_1(item.get(&quot;MOBILE_NO_1&quot;).s());</span>
<span class="fc" id="L101">        student.setMOBILE_NO_2(item.get(&quot;MOBILE_NO_2&quot;).s());</span>
<span class="fc" id="L102">        student.setDIST_NAME(item.get(&quot;DIST_NAME&quot;).s());</span>
<span class="fc" id="L103">        student.setPIN_CODE(item.get(&quot;PIN_CODE&quot;).s());</span>
<span class="fc" id="L104">        return student;</span>
    }

    // Update student
    public UpdateItemResponse updateStudent(Student student) {
<span class="fc" id="L109">        Map&lt;String, AttributeValue&gt; key = new HashMap&lt;&gt;();</span>
<span class="fc" id="L110">        key.put(&quot;AdmissionID&quot;, AttributeValue.builder().s(student.getAdmissionID()).build());</span>
<span class="fc" id="L111">        Map&lt;String, AttributeValueUpdate&gt; updates = new HashMap&lt;&gt;();</span>
        // Updating attributes
<span class="fc" id="L113">        updates.put(&quot;S_NO&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L114">                .value(AttributeValue.builder().s(student.getS_NO()).build())</span>
<span class="fc" id="L115">                .action(AttributeAction.PUT) // PUT means replace the existing value</span>
<span class="fc" id="L116">                .build());</span>

<span class="fc" id="L118">        updates.put(&quot;CollegeID&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L119">                .value(AttributeValue.builder().s(student.getCollegeID()).build())</span>
<span class="fc" id="L120">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L121">                .build());</span>

<span class="fc" id="L123">        updates.put(&quot;CAMPUS&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L124">                .value(AttributeValue.builder().s(student.getCAMPUS()).build())</span>
<span class="fc" id="L125">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L126">                .build());</span>

<span class="fc" id="L128">        updates.put(&quot;Pursuing_branch&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L129">                .value(AttributeValue.builder().s(student.getPursuing_branch()).build())</span>
<span class="fc" id="L130">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L131">                .build());</span>

<span class="fc" id="L133">        updates.put(&quot;Pursuing_campus&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L134">                .value(AttributeValue.builder().s(student.getPursuing_campus()).build())</span>
<span class="fc" id="L135">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L136">                .build());</span>

<span class="fc" id="L138">        updates.put(&quot;AADHAR_NO&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L139">                .value(AttributeValue.builder().s(student.getAADHAR_NO()).build())</span>
<span class="fc" id="L140">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L141">                .build());</span>

<span class="fc" id="L143">        updates.put(&quot;DOB&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L144">                .value(AttributeValue.builder().s(student.getDOB()).build())</span>
<span class="fc" id="L145">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L146">                .build());</span>

<span class="fc" id="L148">        updates.put(&quot;STUDENT_NAME_AS_PER_SSC&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L149">                .value(AttributeValue.builder().s(student.getSTUDENT_NAME_AS_PER_SSC()).build())</span>
<span class="fc" id="L150">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L151">                .build());</span>

<span class="fc" id="L153">        updates.put(&quot;FATHER_NAME_AS_PER_SSC&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L154">                .value(AttributeValue.builder().s(student.getFATHER_NAME_AS_PER_SSC()).build())</span>
<span class="fc" id="L155">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L156">                .build());</span>

<span class="fc" id="L158">        updates.put(&quot;MOTHER_NAME_AS_PER_SSC&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L159">                .value(AttributeValue.builder().s(student.getMOTHER_NAME_AS_PER_SSC()).build())</span>
<span class="fc" id="L160">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L161">                .build());</span>

<span class="fc" id="L163">        updates.put(&quot;OCCUPATION&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L164">                .value(AttributeValue.builder().s(student.getOCCUPATION()).build())</span>
<span class="fc" id="L165">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L166">                .build());</span>

<span class="fc" id="L168">        updates.put(&quot;F_OR_M&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L169">                .value(AttributeValue.builder().s(student.getF_OR_M()).build())</span>
<span class="fc" id="L170">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L171">                .build());</span>

<span class="fc" id="L173">        updates.put(&quot;Roll_Number&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L174">                .value(AttributeValue.builder().s(student.getRoll_Number()).build())</span>
<span class="fc" id="L175">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L176">                .build());</span>

<span class="fc" id="L178">        updates.put(&quot;Section&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L179">                .value(AttributeValue.builder().s(student.getSection()).build())</span>
<span class="fc" id="L180">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L181">                .build());</span>

<span class="fc" id="L183">        updates.put(&quot;profile_picture&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L184">                .value(AttributeValue.builder().s(student.getProfile_picture()).build())</span>
<span class="fc" id="L185">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L186">                .build());</span>

<span class="fc" id="L188">        updates.put(&quot;Student_Class&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L189">                .value(AttributeValue.builder().s(student.getStudent_Class()).build())</span>
<span class="fc" id="L190">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L191">                .build());</span>

<span class="fc" id="L193">        updates.put(&quot;CAST&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L194">                .value(AttributeValue.builder().s(student.getCAST()).build())</span>
<span class="fc" id="L195">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L196">                .build());</span>

<span class="fc" id="L198">        updates.put(&quot;SUB_CAST&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L199">                .value(AttributeValue.builder().s(student.getSUB_CAST()).build())</span>
<span class="fc" id="L200">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L201">                .build());</span>

<span class="fc" id="L203">        updates.put(&quot;MOBILE_NO_1&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L204">                .value(AttributeValue.builder().s(student.getMOBILE_NO_1()).build())</span>
<span class="fc" id="L205">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L206">                .build());</span>

<span class="fc" id="L208">        updates.put(&quot;MOBILE_NO_2&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L209">                .value(AttributeValue.builder().s(student.getMOBILE_NO_2()).build())</span>
<span class="fc" id="L210">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L211">                .build());</span>

<span class="fc" id="L213">        updates.put(&quot;DIST_NAME&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L214">                .value(AttributeValue.builder().s(student.getDIST_NAME()).build())</span>
<span class="fc" id="L215">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L216">                .build());</span>

<span class="fc" id="L218">        updates.put(&quot;PIN_CODE&quot;, AttributeValueUpdate.builder()</span>
<span class="fc" id="L219">                .value(AttributeValue.builder().s(student.getPIN_CODE()).build())</span>
<span class="fc" id="L220">                .action(AttributeAction.PUT)</span>
<span class="fc" id="L221">                .build());</span>
<span class="fc" id="L222">        UpdateItemRequest updateItemRequest = UpdateItemRequest.builder()</span>
<span class="fc" id="L223">                .tableName(tableName)</span>
<span class="fc" id="L224">                .key(key)</span>
<span class="fc" id="L225">                .attributeUpdates(updates)</span>
<span class="fc" id="L226">                .build();</span>
<span class="fc" id="L227">        UpdateItemResponse response=dynamoDbClient.updateItem(updateItemRequest);</span>
<span class="fc" id="L228">        return response;</span>
    }

    // Delete student by ID
    public DeleteItemResponse deleteStudentById(String id) {
<span class="fc" id="L233">        Map&lt;String, AttributeValue&gt; key = new HashMap&lt;&gt;();</span>
<span class="fc" id="L234">        key.put(&quot;AdmissionID&quot;, AttributeValue.builder().s(id).build());</span>

        // Build the DeleteItemRequest with ConditionExpression
<span class="fc" id="L237">        DeleteItemRequest deleteItemRequest = DeleteItemRequest.builder()</span>
<span class="fc" id="L238">                .tableName(tableName)</span>
<span class="fc" id="L239">                .key(key)</span>
<span class="fc" id="L240">                .conditionExpression(&quot;AdmissionID = :id&quot;)</span>
<span class="fc" id="L241">                .expressionAttributeValues(Map.of(</span>
<span class="fc" id="L242">                        &quot;:id&quot;, AttributeValue.builder().s(id).build()</span>
                ))
<span class="fc" id="L244">                .build();</span>

        try {
<span class="fc" id="L247">            DeleteItemResponse deleteItemResponse = dynamoDbClient.deleteItem(deleteItemRequest);</span>
<span class="fc" id="L248">            return deleteItemResponse;</span>
<span class="fc" id="L249">        } catch (ConditionalCheckFailedException e) {</span>
<span class="fc" id="L250">            System.out.println(&quot;Item with ID &quot; + id + &quot; does not exist or condition failed.&quot;);</span>
<span class="fc" id="L251">            return null; // Return null or handle as needed</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>